image: php:7.2-fpm

pipelines:
  default:
    - step:
        name: Build and test
        script:
          - apt-get update && apt-get install -y unzip git
          - curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
          - composer install
          - ./vendor/bin/phpunit
    - step:
        name: Install on Laravel 7.0
        script:
          - apt-get update && apt-get install -y unzip
          - curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
          - composer create-project laravel/laravel laravel "7.0"
          - cd laravel
          - composer config repositories.repo-name vcs git@bitbucket.org:elegantmedia/php-helpers.git
          - composer require emedia/php-helpers ^1.2.0